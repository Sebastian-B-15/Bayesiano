<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sebastian Baeza">

<title>Métodos bayesianos - Ayudantía 6</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Metodos-bayesianos_Ayudantia6_files/libs/clipboard/clipboard.min.js"></script>
<script src="Metodos-bayesianos_Ayudantia6_files/libs/quarto-html/quarto.js"></script>
<script src="Metodos-bayesianos_Ayudantia6_files/libs/quarto-html/popper.min.js"></script>
<script src="Metodos-bayesianos_Ayudantia6_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Metodos-bayesianos_Ayudantia6_files/libs/quarto-html/anchor.min.js"></script>
<link href="Metodos-bayesianos_Ayudantia6_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Metodos-bayesianos_Ayudantia6_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Metodos-bayesianos_Ayudantia6_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Metodos-bayesianos_Ayudantia6_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Metodos-bayesianos_Ayudantia6_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#métodos-bayesianos" id="toc-métodos-bayesianos" class="nav-link active" data-scroll-target="#métodos-bayesianos">Métodos bayesianos</a>
  <ul class="collapse">
  <li><a href="#ayudantía-6---intervalos-de-credibilidad" id="toc-ayudantía-6---intervalos-de-credibilidad" class="nav-link" data-scroll-target="#ayudantía-6---intervalos-de-credibilidad">Ayudantía 6 - Intervalos de credibilidad</a>
  <ul class="collapse">
  <li><a href="#ejercicio-1" id="toc-ejercicio-1" class="nav-link" data-scroll-target="#ejercicio-1">Ejercicio 1</a></li>
  <li><a href="#ejercicio-2" id="toc-ejercicio-2" class="nav-link" data-scroll-target="#ejercicio-2">Ejercicio 2</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Métodos bayesianos - Ayudantía 6</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Sebastian Baeza </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="métodos-bayesianos" class="level1">
<h1>Métodos bayesianos</h1>
<section id="ayudantía-6---intervalos-de-credibilidad" class="level2">
<h2 class="anchored" data-anchor-id="ayudantía-6---intervalos-de-credibilidad">Ayudantía 6 - Intervalos de credibilidad</h2>
<section id="ejercicio-1" class="level3">
<h3 class="anchored" data-anchor-id="ejercicio-1">Ejercicio 1</h3>
<p>Suponga que esta interesado en la proporción de la población de Chile estudiantes universitarios que duermen menos de ocho horas cada noche (<span class="math inline">\(\theta\)</span>). Se posee una muestra aleatoria de 27 estudiantes de la Universidad Católica, donde 11 estudiantes registraron que durmieron al menos ocho horas cada noche. De estudios anteriores se sospecha que la proporción de estudiantes posee una media de <span class="math inline">\(0.3\)</span> y un coeciente de variación igual a <span class="math inline">\(0.45\)</span>.</p>
<ol type="a">
<li>Proponga una distribución para la muestra aleatoria (<span class="math inline">\(X\)</span>). Justique.</li>
</ol>
<p>Claramente la distribución de la muestra aleatoria o verosimilitud, debe corresponder a una bernoulli (binomial), pues un estudiante puede dormir menos de 8 horas o dormir las 8 horas y más. Son dos opciones contrapuestas y únicas, lo que se modela por la distribución bernoulli: <span class="math inline">\(x_i \stackrel{iid}{\sim} Bern(\theta)\)</span>.</p>
<ol start="2" type="a">
<li>Proponga una distribución a priori.</li>
</ol>
<p>Como <span class="math inline">\(\theta\)</span> hace referencia a una proporción/probabilidad, entonces una distribución flexible y con recorrido <span class="math inline">\(]0,1[\)</span> es una <span class="math inline">\(\textup{Beta}(\alpha, \beta)\)</span>. Entonces los parámetros <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> deben ser tales que <span class="math inline">\(E[X] = \frac{\alpha}{\alpha + \beta} = 0.3\)</span>, <span class="math inline">\(Var[X] = \frac{\alpha \beta}{(\alpha + \beta)^2 (\alpha + \beta + 1)} = (0.45 \cdot 0.3)^2\)</span>. Procedemos con el cálculo:<br> <span class="math inline">\(\frac{\alpha \beta}{(\alpha + \beta)^2 (\alpha + \beta + 1)} = 0.018225, \alpha = 0.3(\alpha + \beta)\)</span><br> <span class="math inline">\(\Rightarrow 0.3 \frac{\beta}{(\alpha + \beta) (\alpha + \beta + 1)} = 0.018225, \alpha = \frac{0.3}{0.7} \beta\)</span><br> <span class="math inline">\(\Rightarrow \frac{\beta}{(10\beta/7)^2 + (10\beta/7)} = 0.06075, \alpha = \frac{3}{7} \beta\)</span><br> <span class="math inline">\(\Rightarrow \beta - 0.06075(10\beta/7)^2 - 0.06075(10\beta/7) = 0, \alpha = \frac{3}{7} \beta\)</span><br> <span class="math inline">\(\Rightarrow - 0.1239796\beta^2 + 0.9132143\beta = 0, \alpha = \frac{3}{7} \beta\)</span><br> <span class="math inline">\(\Rightarrow \beta (\beta - 7.365843) = 0, \alpha = \frac{3}{7} \beta\)</span><br> <span class="math inline">\(\Rightarrow \beta = 7.365843, \alpha = 3.15679\)</span>.</p>
<p>Una forma de calcular este sistema usando RStudio es la siguiente (también se puede usar multiroot):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nleqslv) <span class="co">#cargamos la librería respectiva nleqslv por ejemplo</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'nleqslv' was built under R version 4.2.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ecuaciones <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  ec1 <span class="ot">&lt;-</span> x[<span class="dv">1</span>]<span class="sc">/</span>(x[<span class="dv">1</span>] <span class="sc">+</span> x[<span class="dv">2</span>]) <span class="sc">-</span> <span class="fl">0.3</span> <span class="co">#esta es la función de la primera ecuación igualada a 0: f(x,y) = 0</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  ec2 <span class="ot">&lt;-</span> x[<span class="dv">1</span>]<span class="sc">*</span>x[<span class="dv">2</span>]<span class="sc">/</span>((x[<span class="dv">1</span>] <span class="sc">+</span> x[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (x[<span class="dv">1</span>] <span class="sc">+</span> x[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">-</span> <span class="fl">0.018225</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(ec1, ec2))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>guess <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>) <span class="co">#Valor inicial para las iteraciones</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">nleqslv</span>(guess, ecuaciones) <span class="co">#El valor indicado por $x es cercano al que estimamos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x
[1] 3.156790 7.365844

$fvec
[1] -3.858034e-10 -1.345912e-11

$termcd
[1] 1

$message
[1] "Function criterion near zero"

$scalex
[1] 1 1

$nfcnt
[1] 24

$njcnt
[1] 1

$iter
[1] 14</code></pre>
</div>
</div>
<ol start="3" type="a">
<li>Encuentre la distribución a posteriori para el/los parámetros.</li>
</ol>
<p>Se sabe que si se tiene una verosimilitud binomial y una a priori beta entonces la distribución a posteriori es beta:</p>
<p><span class="math inline">\(p(\theta|x) \propto \theta^{\sum x_i} (1-\theta)^{n - \sum x_i} \cdot \theta^{\alpha - 1} (1-\theta)^{\beta - 1} \cdot 1_{(0,1)}(\theta)\)</span><br> <span class="math inline">\(\propto \theta^{\sum x_i + \alpha - 1} (1-\theta)^{n - \sum x_i + \beta - 1} \cdot 1_{(0,1)}(\theta)\)</span><br> Entonces <span class="math inline">\(\theta|x \sim \textup{Beta}(\sum x_i + \alpha, n - \sum x_i + \beta)\)</span>. Luego, reemplazando con los valores respectivos del enunciado <span class="math inline">\(n = 27\)</span>, <span class="math inline">\(\sum x_i = 11\)</span>, <span class="math inline">\(\alpha = 3.15679\)</span> y <span class="math inline">\(\beta = 7.365843\)</span>, se tiene que <span class="math inline">\(\theta|x \sim \textup{Beta}(14.2, 23.4)\)</span>.</p>
<ol start="4" type="a">
<li>Encuentre el intervalo de credibilidad a un para el/los parámetros</li>
</ol>
<p>Primero cargaremos una librería con una función para encontrar la región HPD:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TeachingDemos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Definimos los parámetros</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>alpha_post <span class="ot">=</span> <span class="fl">14.2</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>beta_post <span class="ot">=</span> <span class="fl">23.4</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aplicamos la función para encontrar la región HPD con un 90% de credibilidad</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(intervalo <span class="ot">&lt;-</span> <span class="fu">hpd</span>(qbeta, <span class="at">shape1 =</span> alpha_post, <span class="at">shape2 =</span> beta_post, <span class="at">conf =</span> <span class="fl">0.9</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2486939 0.5051835</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#El primer argumento es la función inversa a la FDA</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Los demás argumentos son los parámetros de la FDA y conf= es la credibilidad</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Por otro lado, si deseamos una región o intervalo clásico <span class="math inline">\([qB_{(\alpha/2)}, qB_{(1-\alpha/2)}]\)</span>, podemos usar:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>q_lower <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.05</span>, alpha_post, beta_post)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>q_upper <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.95</span>, alpha_post, beta_post)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(q_lower, q_upper)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2529544 0.5098646</code></pre>
</div>
</div>
<p>Este último intervalo es bastante similar al HPD.</p>
</section>
<section id="ejercicio-2" class="level3">
<h3 class="anchored" data-anchor-id="ejercicio-2">Ejercicio 2</h3>
<p>Supongamos que durante una expedición de captura de animales, se registra el número de veces que se captura un animal de la especie, cuya distribucón es <span class="math inline">\(P(\theta)\)</span>. Suponga un distribución previa <span class="math inline">\(\textup{Gamma}\)</span> para <span class="math inline">\(\theta\)</span>.</p>
<p>Considere la secuencia de variables aleatorias <span class="math inline">\(x_1, ..., x_n\)</span> con función de verosimilitud <span class="math inline">\(P(\theta)\)</span> donde <span class="math inline">\(\theta\)</span> tiene una distribución a priori <span class="math inline">\(\textup{Gamma}(\alpha, \beta)\)</span>.</p>
<ol type="a">
<li>Encuentre la región de credibilidad <span class="math inline">\((1-\alpha)100%\)</span> a posteriori para <span class="math inline">\(\theta\)</span>.</li>
</ol>
<p>La distribución a posteriori es una gamma: <span class="math inline">\(p(\theta|x) \propto e^{-n\theta} \cdot \theta^{\sum x_i} \cdot e^{- \beta \theta} \cdot \theta^{\alpha - 1} \cdot 1_{\mathbb{R}^+}(\theta)\)</span><br> <span class="math inline">\(p(\theta|x) \propto e^{-(\beta + n)\theta} \cdot \theta^{\sum x_i + \alpha - 1} \cdot 1_{\mathbb{R}^+}(\theta)\)</span> Luego <span class="math inline">\(\theta|x \sim \textup{Gamma}(\sum x_i + \alpha, \beta + n)\)</span></p>
<ol start="2" type="a">
<li>Considere el siguiente registro: (118, 74, 44, 24, 29, 22, 20, 14, 20, 15, 12, 14, 6, 12, 6, 9, 9, 6, 10, 10, 11, 5, 3, 3), de modo que 118 especies se observaron una sola vez, 74 especies se observaron dos veces, y así sucesivamente, con un total de 3266 animales capturados y una priori no informativa. Utilice R para encontrar el intervalo de credibilidad a un para el parámetro</li>
</ol>
<p>Notemos que el registro hace referencia a una tabla de frecuencias, de forma que solo un animal de cierta especie fue capturado en 118 ocasiones (lo que en datos limpios son 118 “unos”). Escribimos este registro:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>registro <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">118</span>, <span class="dv">74</span>, <span class="dv">44</span>, <span class="dv">24</span>, <span class="dv">29</span>, <span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">14</span>, <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">6</span>, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Escribimos un vector con todos los datos, esto es repetir el valor <span class="math inline">\(i\)</span> tantas veces como la <span class="math inline">\(i\)</span>-ésima posición del vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(registro)) {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="fu">rep</span>(i, registro[i]))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(x) <span class="co"># Deberíamos obtener el registro</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 
118  74  44  24  29  22  20  14  20  15  12  14   6  12   6   9   9   6  10  10 
 21  22  23  24 
 11   5   3   3 </code></pre>
</div>
</div>
<p>Calculamos los valores de interés de la distribución:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>suma_x <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>alpha_1 <span class="ot">&lt;-</span> suma_x <span class="sc">+</span> alpha</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> n <span class="sc">+</span> beta</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculamos el intervalo HPD con la función correspondiente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hpd</span>(qgamma, <span class="at">shape =</span> alpha_1, <span class="at">rate =</span> beta_1, <span class="at">conf =</span> <span class="fl">0.95</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.34862 6.79939</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>